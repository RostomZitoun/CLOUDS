{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"C:\\\\Users\\\\Majed\\\\Desktop\\\\lib\\\\covidapp\\\\src\\\\index.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Route, BrowserRouter as Router, Switch } from 'react-router-dom';\nimport './index.css';\nimport HomePage from './components/Homepage';\nimport CountryPage from './components/CountryPage';\nimport firebase from './firebase';\nlet firestore = firebase.firestore();\nlet ref = firestore.collection('countries');\n\nlet timeInterval = t => new Promise((res, rej) => setTimeout(_ => res(), t));\n\nref.get().then(async snapshot => {\n  let failures = [];\n\n  for (let doc of snapshot.docs) {\n    let h = await ref.doc(doc.id).get();\n\n    if (h.data().history.length) {\n      console.log('skipping');\n      continue;\n    }\n\n    let data = await fetch('https://api.covid19api.com/country/' + doc.id).then(d => d.json());\n\n    if (data.message || data.length == 0) {\n      console.log('failure in', doc.id);\n      failures.push(doc.id);\n      await timeInterval(1000);\n      continue; //handle failure\n      //--start 2020-01-23T00:00:00Z\n    } else {\n      let nData = [];\n\n      if (doc.id == 'china') {\n        //fuck\n        let idx = 0;\n\n        for (let i = 0; i < data.length;) {\n          let model = {\n            Date: null,\n            Confirmed: 0,\n            Recovered: 0,\n            Deaths: 0\n          };\n          model.Date = data[idx].Date;\n\n          while (data[i] && data[idx].Date == data[i].Date) {\n            model.Confirmed += data[i].Confirmed;\n            model.Recovered += data[i].Recovered;\n            model.Deaths += data[i].Deaths;\n            i++;\n          }\n\n          idx = i;\n          nData.push(model);\n        }\n\n        console.log(nData);\n      }\n\n      data = nData;\n      let d = data[0],\n          history = [];\n      console.log(d);\n      let value = {\n        Date: d.Date,\n        TotalConfirmed: d.Confirmed,\n        NewConfirmed: d.Confirmed,\n        TotalRecovered: d.Recovered,\n        NewRecovered: d.Recovered,\n        TotalDeaths: d.Deaths,\n        NewDeaths: d.Deaths\n      };\n      history.push(Object.assign({}, value));\n\n      for (let i = 1; i < data.length; i++) {\n        d = data[i];\n        let newValue = {\n          Date: d.Date,\n          TotalConfirmed: d.Confirmed,\n          NewConfirmed: d.Confirmed - value.TotalConfirmed,\n          TotalRecovered: d.Recovered,\n          NewRecovered: d.Recovered - value.TotalRecovered,\n          TotalDeaths: d.Deaths,\n          NewDeaths: d.Deaths - value.TotalDeaths\n        };\n        value = Object.assign(value, newValue);\n        history.push(newValue);\n      }\n\n      await ref.doc(doc.id).set({\n        history\n      });\n    }\n\n    await timeInterval(3000);\n  }\n\n  console.log('DONE', failures);\n});\nReactDOM.render( /*#__PURE__*/_jsxDEV(Router, {\n  children: /*#__PURE__*/_jsxDEV(Switch, {\n    children: [/*#__PURE__*/_jsxDEV(Route, {\n      exact: true,\n      path: \"/:country\",\n      component: CountryPage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 4\n    }, this), /*#__PURE__*/_jsxDEV(Route, {\n      path: \"/\",\n      component: HomePage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 4\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 94,\n    columnNumber: 3\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 93,\n  columnNumber: 3\n}, this), document.getElementById('root'));","map":{"version":3,"sources":["C:/Users/Majed/Desktop/lib/covidapp/src/index.js"],"names":["React","ReactDOM","Route","BrowserRouter","Router","Switch","HomePage","CountryPage","firebase","firestore","ref","collection","timeInterval","t","Promise","res","rej","setTimeout","_","get","then","snapshot","failures","doc","docs","h","id","data","history","length","console","log","fetch","d","json","message","push","nData","idx","i","model","Date","Confirmed","Recovered","Deaths","value","TotalConfirmed","NewConfirmed","TotalRecovered","NewRecovered","TotalDeaths","NewDeaths","Object","assign","newValue","set","render","document","getElementById"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,SAAQC,KAAR,EAAeC,aAAa,IAAIC,MAAhC,EAAwCC,MAAxC,QAAqD,kBAArD;AAEA,OAAO,aAAP;AACA,OAAOC,QAAP,MAAqB,uBAArB;AACA,OAAOC,WAAP,MAAwB,0BAAxB;AAEA,OAAOC,QAAP,MAAqB,YAArB;AACA,IAAIC,SAAS,GAAGD,QAAQ,CAACC,SAAT,EAAhB;AACA,IAAIC,GAAG,GAAGD,SAAS,CAACE,UAAV,CAAqB,WAArB,CAAV;;AAEA,IAAIC,YAAY,GAAIC,CAAD,IAAO,IAAIC,OAAJ,CAAY,CAACC,GAAD,EAAMC,GAAN,KAAcC,UAAU,CAACC,CAAC,IAAIH,GAAG,EAAT,EAAaF,CAAb,CAApC,CAA1B;;AAEAH,GAAG,CAACS,GAAJ,GAAUC,IAAV,CAAe,MAAOC,QAAP,IAAoB;AAClC,MAAIC,QAAQ,GAAG,EAAf;;AACA,OAAM,IAAIC,GAAV,IAAiBF,QAAQ,CAACG,IAA1B,EAAiC;AAChC,QAAIC,CAAC,GAAG,MAAMf,GAAG,CAACa,GAAJ,CAAQA,GAAG,CAACG,EAAZ,EAAgBP,GAAhB,EAAd;;AACA,QAAIM,CAAC,CAACE,IAAF,GAASC,OAAT,CAAiBC,MAArB,EAA6B;AAAEC,MAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AAAyB;AAAW;;AAEnE,QAAIJ,IAAI,GAAG,MAAMK,KAAK,CAAC,wCAAsCT,GAAG,CAACG,EAA3C,CAAL,CAAoDN,IAApD,CAAyDa,CAAC,IAAIA,CAAC,CAACC,IAAF,EAA9D,CAAjB;;AACA,QAAKP,IAAI,CAACQ,OAAL,IAAgBR,IAAI,CAACE,MAAL,IAAe,CAApC,EAAwC;AACvCC,MAAAA,OAAO,CAACC,GAAR,CAAY,YAAZ,EAA0BR,GAAG,CAACG,EAA9B;AACAJ,MAAAA,QAAQ,CAACc,IAAT,CAAcb,GAAG,CAACG,EAAlB;AACA,YAAMd,YAAY,CAAC,IAAD,CAAlB;AACA,eAJuC,CAKvC;AACA;AACA,KAPD,MAOO;AACN,UAAIyB,KAAK,GAAG,EAAZ;;AACA,UAAKd,GAAG,CAACG,EAAJ,IAAU,OAAf,EAAyB;AACxB;AACA,YAAIY,GAAG,GAAG,CAAV;;AACA,aAAM,IAAIC,CAAC,GAAG,CAAd,EAAiBA,CAAC,GAAGZ,IAAI,CAACE,MAA1B,GAAoC;AACnC,cAAIW,KAAK,GAAG;AACXC,YAAAA,IAAI,EAAE,IADK;AAEXC,YAAAA,SAAS,EAAE,CAFA;AAEGC,YAAAA,SAAS,EAAE,CAFd;AAEiBC,YAAAA,MAAM,EAAE;AAFzB,WAAZ;AAKAJ,UAAAA,KAAK,CAACC,IAAN,GAAad,IAAI,CAACW,GAAD,CAAJ,CAAUG,IAAvB;;AACA,iBAAQd,IAAI,CAACY,CAAD,CAAJ,IAAWZ,IAAI,CAACW,GAAD,CAAJ,CAAUG,IAAV,IAAkBd,IAAI,CAACY,CAAD,CAAJ,CAAQE,IAA7C,EAAoD;AACnDD,YAAAA,KAAK,CAACE,SAAN,IAAmBf,IAAI,CAACY,CAAD,CAAJ,CAAQG,SAA3B;AACAF,YAAAA,KAAK,CAACG,SAAN,IAAmBhB,IAAI,CAACY,CAAD,CAAJ,CAAQI,SAA3B;AACAH,YAAAA,KAAK,CAACI,MAAN,IAAgBjB,IAAI,CAACY,CAAD,CAAJ,CAAQK,MAAxB;AACAL,YAAAA,CAAC;AACD;;AACDD,UAAAA,GAAG,GAAGC,CAAN;AACAF,UAAAA,KAAK,CAACD,IAAN,CAAWI,KAAX;AACA;;AAEDV,QAAAA,OAAO,CAACC,GAAR,CAAYM,KAAZ;AACA;;AACDV,MAAAA,IAAI,GAAGU,KAAP;AACA,UAAIJ,CAAC,GAAGN,IAAI,CAAC,CAAD,CAAZ;AAAA,UAAiBC,OAAO,GAAG,EAA3B;AACAE,MAAAA,OAAO,CAACC,GAAR,CAAYE,CAAZ;AACA,UAAIY,KAAK,GAAG;AACXJ,QAAAA,IAAI,EAAER,CAAC,CAACQ,IADG;AAEXK,QAAAA,cAAc,EAAEb,CAAC,CAACS,SAFP;AAGXK,QAAAA,YAAY,EAAEd,CAAC,CAACS,SAHL;AAIXM,QAAAA,cAAc,EAAEf,CAAC,CAACU,SAJP;AAKXM,QAAAA,YAAY,EAAEhB,CAAC,CAACU,SALL;AAMXO,QAAAA,WAAW,EAAEjB,CAAC,CAACW,MANJ;AAOXO,QAAAA,SAAS,EAAElB,CAAC,CAACW;AAPF,OAAZ;AAUAhB,MAAAA,OAAO,CAACQ,IAAR,CAAagB,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBR,KAAlB,CAAb;;AACA,WAAM,IAAIN,CAAC,GAAG,CAAd,EAAiBA,CAAC,GAAGZ,IAAI,CAACE,MAA1B,EAAkCU,CAAC,EAAnC,EAAwC;AACvCN,QAAAA,CAAC,GAAGN,IAAI,CAACY,CAAD,CAAR;AACA,YAAIe,QAAQ,GAAG;AACdb,UAAAA,IAAI,EAAER,CAAC,CAACQ,IADM;AAEdK,UAAAA,cAAc,EAAEb,CAAC,CAACS,SAFJ;AAGdK,UAAAA,YAAY,EAAEd,CAAC,CAACS,SAAF,GAAcG,KAAK,CAACC,cAHpB;AAIdE,UAAAA,cAAc,EAAEf,CAAC,CAACU,SAJJ;AAKdM,UAAAA,YAAY,EAAEhB,CAAC,CAACU,SAAF,GAAcE,KAAK,CAACG,cALpB;AAMdE,UAAAA,WAAW,EAAEjB,CAAC,CAACW,MAND;AAOdO,UAAAA,SAAS,EAAElB,CAAC,CAACW,MAAF,GAAWC,KAAK,CAACK;AAPd,SAAf;AAUAL,QAAAA,KAAK,GAAGO,MAAM,CAACC,MAAP,CAAcR,KAAd,EAAqBS,QAArB,CAAR;AACA1B,QAAAA,OAAO,CAACQ,IAAR,CAAakB,QAAb;AACA;;AAED,YAAM5C,GAAG,CAACa,GAAJ,CAAQA,GAAG,CAACG,EAAZ,EAAgB6B,GAAhB,CAAoB;AAAC3B,QAAAA;AAAD,OAApB,CAAN;AACA;;AACD,UAAMhB,YAAY,CAAC,IAAD,CAAlB;AAEA;;AAEDkB,EAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBT,QAApB;AACE,CA3EH;AA6EArB,QAAQ,CAACuD,MAAT,eACE,QAAC,MAAD;AAAA,yBACA,QAAC,MAAD;AAAA,4BACC,QAAC,KAAD;AAAO,MAAA,KAAK,MAAZ;AAAa,MAAA,IAAI,EAAC,WAAlB;AAA8B,MAAA,SAAS,EAAEjD;AAAzC;AAAA;AAAA;AAAA;AAAA,YADD,eAEC,QAAC,KAAD;AAAO,MAAA,IAAI,EAAC,GAAZ;AAAgB,MAAA,SAAS,EAAED;AAA3B;AAAA;AAAA;AAAA;AAAA,YAFD;AAAA;AAAA;AAAA;AAAA;AAAA;AADA;AAAA;AAAA;AAAA;AAAA,QADF,EAOEmD,QAAQ,CAACC,cAAT,CAAwB,MAAxB,CAPF","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport {Route, BrowserRouter as Router, Switch} from 'react-router-dom';\n\nimport './index.css';\nimport HomePage from './components/Homepage';\nimport CountryPage from './components/CountryPage';\n\nimport firebase from './firebase';\nlet firestore = firebase.firestore();\nlet ref = firestore.collection('countries');\n\nlet timeInterval = (t) => new Promise((res, rej) => setTimeout(_ => res(), t));\n\nref.get().then(async (snapshot) => {\n\tlet failures = [];\n\tfor ( let doc of snapshot.docs ) {\n\t\tlet h = await ref.doc(doc.id).get();\n\t\tif (h.data().history.length) { console.log('skipping'); continue; }\n\t\t\n\t\tlet data = await fetch('https://api.covid19api.com/country/'+doc.id).then(d => d.json());\n\t\tif ( data.message || data.length == 0 ) {\n\t\t\tconsole.log('failure in', doc.id);\n\t\t\tfailures.push(doc.id);\n\t\t\tawait timeInterval(1000);\n\t\t\tcontinue;\n\t\t\t//handle failure\n\t\t\t//--start 2020-01-23T00:00:00Z\n\t\t} else {\n\t\t\tlet nData = [];\n\t\t\tif ( doc.id == 'china' ) {\n\t\t\t\t//fuck\n\t\t\t\tlet idx = 0;\n\t\t\t\tfor ( let i = 0; i < data.length; ) {\n\t\t\t\t\tlet model = {\n\t\t\t\t\t\tDate: null,\n\t\t\t\t\t\tConfirmed: 0, Recovered: 0, Deaths: 0\n\t\t\t\t\t};\n\n\t\t\t\t\tmodel.Date = data[idx].Date;\n\t\t\t\t\twhile ( data[i] && data[idx].Date == data[i].Date ) {\n\t\t\t\t\t\tmodel.Confirmed += data[i].Confirmed;\n\t\t\t\t\t\tmodel.Recovered += data[i].Recovered;\n\t\t\t\t\t\tmodel.Deaths += data[i].Deaths;\n\t\t\t\t\t\ti++;\n\t\t\t\t\t}\n\t\t\t\t\tidx = i;\n\t\t\t\t\tnData.push(model);\n\t\t\t\t}\n\n\t\t\t\tconsole.log(nData);\n\t\t\t}\n\t\t\tdata = nData;\n\t\t\tlet d = data[0], history = [];\n\t\t\tconsole.log(d);\n\t\t\tlet value = {\n\t\t\t\tDate: d.Date,\n\t\t\t\tTotalConfirmed: d.Confirmed,\n\t\t\t\tNewConfirmed: d.Confirmed,\n\t\t\t\tTotalRecovered: d.Recovered,\n\t\t\t\tNewRecovered: d.Recovered,\n\t\t\t\tTotalDeaths: d.Deaths,\n\t\t\t\tNewDeaths: d.Deaths\n\t\t\t};\n\n\t\t\thistory.push(Object.assign({}, value));\n\t\t\tfor ( let i = 1; i < data.length; i++ ) {\n\t\t\t\td = data[i];\n\t\t\t\tlet newValue = {\n\t\t\t\t\tDate: d.Date,\n\t\t\t\t\tTotalConfirmed: d.Confirmed,\n\t\t\t\t\tNewConfirmed: d.Confirmed - value.TotalConfirmed,\n\t\t\t\t\tTotalRecovered: d.Recovered,\n\t\t\t\t\tNewRecovered: d.Recovered - value.TotalRecovered,\n\t\t\t\t\tTotalDeaths: d.Deaths,\n\t\t\t\t\tNewDeaths: d.Deaths - value.TotalDeaths\n\t\t\t\t};\n\n\t\t\t\tvalue = Object.assign(value, newValue);\n\t\t\t\thistory.push(newValue);\n\t\t\t}\n\n\t\t\tawait ref.doc(doc.id).set({history});\t\n\t\t}\n\t\tawait timeInterval(3000);\n\t\t\n\t}\n\n\tconsole.log('DONE', failures);\n  });\n\nReactDOM.render(\n  <Router>\n\t\t<Switch>\n\t\t\t<Route exact path=\"/:country\" component={CountryPage}/>\n\t\t\t<Route path=\"/\" component={HomePage}/>\n\t\t</Switch> \n  </Router>,\n  document.getElementById('root')\n);"]},"metadata":{},"sourceType":"module"}